#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP  [··/·]  (TDB) verify totalling and writing waves                            0s  waves           TDB_write                                                                    ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the global data                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        PROG__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char     *x_tdb   = "/tmp/ouroboros.tdb";                                                                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   char     *x_wave  = "/tmp/koios_code.wave";                                                                                                                                                                                 
     exec     clean up file                        yENV_rm                     x_wave                                                                                                c_equal     '-'                                                                                                  

   COND       verify writing empty database                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call write                           TDB_write                   x_tdb                                                                                                 i_equal     0                                                                                                    

   COND       verify database itself                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     get      ... check record count               yENV_lines                  x_tdb                                                                                                 i_equal     14                                                                                                   
     get      ... look at contents                 yENV_peek                   x_tdb              ,  0                                                                               w_equal     å#!/usr/local/bin/ouroborosæ                                                              
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## ouroboros-aperantos (tail-eater) master unit testing sequenceræ                      
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## central wave and dependency databaseæ                                                             
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## version      å¬.¬¬æ ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## last updated å¬¬.¬¬.¬¬.¬¬.¬¬.¬¬.¬.¬¬.¬¬¬æ ¬¬¬¬¬¬¬¬¬¬                                               
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å##------ § ---timestamp-------------- § ---epoch-- § ---project---------- § ---unit----------------------- § sc § S § ---description-------------------------------------------------------- § ---terse------------ § w § s § i § #units § #scrps § #conds § #steps § est § expect § R § #pass# § #fail# § #badd# § #void# § #miss# § actual § act § -pass- § -fail- § -warn- § -none- §æ
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å## GRAND § =========´=========´====== § =========´ §   0 =====´=========´ § ##=======´=========´=========´ § == § = § =========´=========´=========´=========´=========´=========´=========´ § =========´=========´ § = § = § = §      0 §      0 §      0 §      0 §  <s §      0 § = §      0 §      0 §      0 §      0 §      0 §      0 §  <s §      0 §      0 §      0 §      0 §æ
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## end-of-data.  done, finito, completare, whimper [Ï´···æ
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å(n/a)æ                                                                                               

   COND       verify a small set of starting data                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     file     create and clear script file         - - - - - - - - - - - - -   [[ x_wave ]]                                                                                                                                                                                                               
     append   add lines                            - - - - - - - - - - - - -   WAVE § 24.04.09.04.37.46.2.15.100 § 1234567890 § koios                § koios_code                     §  1 § (CODE) verify configuration handling                              § config               § 2 § h §   0 §   1 §   5 §  10 §  0s §   0 § P §  10 §   0 §   0 §   0 §   0 §     0 §  
     append   add lines                            - - - - - - - - - - - - -   WAVE § 24.04.09.04.37.46.2.15.100 § 1234567890 § koios                § koios_code                     §  2 § (CODE) verify handling of script verbs                            § script               § 1 § a §   0 §   1 §  12 § 105 § 12s §   0 § F §  97 §   5 §   2 §   1 §   0 §     9 §  
     get      ... check record count               yENV_lines                  x_wave                                                                                                i_equal     2                                                                                                    

   COND       verify gathering a wave file                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call gather                          WAVE_gather                 "koios"            , "koios_code.wave"        , x_wave                     , TYPE_WAVE                i_equal     4                                                                                                    

   COND       verify first load                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.013))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     get      check count                          WAVE_count                                                                                                                        i_equal     4                                                                                                    
     get      check entry                          WAVE__unit                  "full"        , 0                                                                                     s_equal     WAVE full   ( 0) : y ·· koios                                 0 · · ·            ·                                ·   ·   ·   ·   ·   ·  ·   ·   ·   ·   ·   ·  ·                          0 
     get      check entry                          WAVE__unit                  "full"        , 1                                                                                     s_equal     WAVE full   ( 1) : y ·· koios           koios_code            0 · · ·            ·                                ·   ·   ·   ·   ·   ·  ·   ·   ·   ·   ·   ·  ·                          0 
     get      check entry                          WAVE__unit                  "full"        , 2                                                                                     s_equal     WAVE full   ( 2) : y ·· koios           koios_code            1 2 h config       (CODE) verify configuration ha   0   1   5  10  0s   0  P  10   0   0   0   0  24.04.09.04.37.46.2.15.100 1234567890 
     get      check entry                          WAVE__unit                  "full"        , 3                                                                                     s_equal     WAVE full   ( 3) : y ·· koios           koios_code            2 1 a script       (CODE) verify handling of scri   0   1  12 105 12s  12  F  97   5   2   1   9  24.04.09.04.37.46.2.15.100 1234567890 
     get      check entry                          WAVE__unit                  "full"        , 4                                                                                     s_equal     WAVE full   ( 4) : · ·· ·               ·                     · · · ·            ·                                ·   ·   ·   ·   ·   ·  ·   ·   ·   ·   ·   ·  ·                          · 

   COND       verify writing small, single project database                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call write                           TDB_write                   x_tdb                                                                                                 i_equal     0                                                                                                    

   COND       verify database itself                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     get      ... check record count               yENV_lines                  x_tdb                                                                                                 i_equal     23                                                                                                   
     get      ... look at contents                 yENV_peek                   x_tdb              ,  0                                                                               w_equal     å#!/usr/local/bin/ouroborosæ                                                              
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## ouroboros-aperantos (tail-eater) master unit testing sequenceræ                      
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## central wave and dependency databaseæ                                                             
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## version      å¬.¬¬æ ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## last updated å¬¬.¬¬.¬¬.¬¬.¬¬.¬¬.¬.¬¬.¬¬¬æ ¬¬¬¬¬¬¬¬¬¬                                               
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å##------ § ---timestamp-------------- § ---epoch-- § ---project---------- § ---unit----------------------- § sc § S § ---description-------------------------------------------------------- § ---terse------------ § w § s § i § #units § #scrps § #conds § #steps § est § expect § R § #pass# § #fail# § #badd# § #void# § #miss# § actual § act § -pass- § -fail- § -warn- § -none- §æ
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     åPROJ==== § =========´=========´====== § =========´ § koios                § ##=======´=========´=========´ § == § = § =========´=========´=========´=========´=========´=========´=========´ § =========´=========´ § = § = § = §      1 §      2 §     17 §    115 § 12s §     12 § = §    107 §      5 §      2 §      1 §      0 §      9 §  9s §      1 §      1 §      0 §      0 §æ
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å  UNIT·· § ·························· § ·········· § koios                § koios_code                     § ## § S § ---description-------------------------------------------------------- § ---terse------------ § - § - § - §      0 §      2 §     17 §    115 § 12s §     12 § - §    107 §      5 §      2 §      1 §      0 §      9 §  9s §      1 §      1 §      0 §      0 §æ
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å    WAVE § ¬¬.¬¬.¬¬.¬¬.¬¬.¬¬.¬.¬¬.¬¬¬ § ¬¬¬¬¬¬¬¬¬¬ § koios                § koios_code                     § 01 § · § (CODE) verify configuration handling                                   § config               § 2 § h § · §      0 §      1 §      5 §     10 §  0s §      0 § P §     10 §      0 §      0 §      0 §      0 §      0 §  <s §      Ï §      · §      · §      · §æ
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å    WAVE § ¬¬.¬¬.¬¬.¬¬.¬¬.¬¬.¬.¬¬.¬¬¬ § ¬¬¬¬¬¬¬¬¬¬ § koios                § koios_code                     § 02 § · § (CODE) verify handling of script verbs                                 § script               § 1 § a § · §      0 §      1 §     12 §    105 § 12s §     12 § F §     97 §      5 §      2 §      1 §      0 §      9 §  9s §      · §      Ï §      · §      · §æ
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å##------ § ---timestamp-------------- § ---epoch-- § ---project---------- § ---unit----------------------- § sc § S § ---description-------------------------------------------------------- § ---terse------------ § w § s § i § #units § #scrps § #conds § #steps § est § expect § R § #pass# § #fail# § #badd# § #void# § #miss# § actual § act § -pass- § -fail- § -warn- § -none- §æ
     get      ... look at contents                 yENV_peek_field             x_tdb              , 'Ö'                                                                              w_equal     å## GRAND § =========´=========´====== § =========´ §   1 =====´=========´ § ##=======´=========´=========´ § == § = § =========´=========´=========´=========´=========´=========´=========´ § =========´=========´ § = § = § = §      1 §      2 §     17 §    115 § 12s §     12 § = §    107 §      5 §      2 §      1 §      0 §      9 §  9s §      1 §      1 §      0 §      0 §æ
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     åæ                                                                                                    
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å## end-of-data.  done, finito, completare, whimper [Ï´···æ
     get      ... look at contents                 yENV_peek                   x_tdb              , 'Ö'                                                                              w_equal     å(n/a)æ                                                                                               



   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     clean up file                        yENV_rm                     x_wave                                                                                                c_equal     '-'                                                                                                  
     exec     stop testing                         PROG__unit_end                                                                                                                    i_equal     0                                                                                                    

# end-of-file.  done, finito, completare, whimper [Ï´···
